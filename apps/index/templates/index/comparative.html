{% extends 'index/base.html' %} 
{% load static %} 
{% block head %}
<script src="{% static 'index/interactive.js' %}"></script>
<script>
  set_navbar_active("#nav-comparative")

  function id2target(string,target){
    return string.replace(/(#)([^'" ]*)/gm,"$1"+target.replace("#","")+"$2")
  }

  function load_column_filtering(target){
    $.ajax({
      url: '/filtering?id={{event_log.id}}',
      success: function(html) {
        var content = $('<div />').html(html).find('#content');
        $(target+"-column-filtering").html(content);
        var id = content.find('[name="id"]').attr("value")
        register_oc_table(target)
        register_histogram(target+"-column-filtering",id)
        $(target).find('#column-filter').submit(function(e){
          e.preventDefault();
          loading_show(target,"#btn-submit")
          $.ajax({
            url: e.target.action,
            type: 'post',
            data:$(target).find('#column-filter').serialize(),
            success:function(response){
              load_row_filtering(response,target)
              loading_hide(target,"#btn-submit")
              $(target+"-column-filtering").parent().collapse("hide")
            }
          });
        });
      }
    });
  }

  function load_row_filtering(html,target){
    var content = $('<div />').html(html).find('#content');
    var id = content.find('[name="id"]').attr("value");
    $(target+"-row-filtering").html(content);
    $(target+"-row-filtering").parent().collapse("show")
    register_cell_table(target,id)
    $(target).find('#cell-filter').submit(function(e){
      e.preventDefault();
      loading_show(target,"#btn-create-cell")
      $.ajax({
        url: e.target.action,
        type: 'post',
        data:$(target).find('#cell-filter').serialize(),
        success:function(response){
          load_visualization(response,target)
          loading_hide(target,"#btn-create-cell")
          $(target + "-row-filtering").parent().collapse("hide")
        }
      });
    });
  }

  function load_visualization(html,target){
    var content = $('<div />').html(html).find('#content');
    var id = content.find('[name="id"]').attr("value")
    $(target+"-visualization").html(content);
    $(target+"-visualization").parent().collapse("show")
    register_vis_buttons(target,id)
    register_histogram(target+"-visualization",id)
  }
</script>
<script>
  $( document ).ready(function() {
    //$("#left-content").load("/filtering?id={{event_log.id}} #content");
    load_column_filtering("#left-content")
    load_column_filtering("#right-content")
});
</script>
{% endblock head %}

{% block content %}
<div class="container-fluid" >
  <div class="row">
<div class="col" id="left-content" style="width:50%">
  <div class="accordion" id="accordionPanelsStayOpenExample">
    <div class="accordion-item">
      <h2 class="accordion-header" id="panelsStayOpen-headingOne">
        <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapseOne" aria-expanded="true" aria-controls="panelsStayOpen-collapseOne">
          Column Filtering
        </button>
      </h2>
      <div id="panelsStayOpen-collapseOne" class="accordion-collapse collapse show" aria-labelledby="panelsStayOpen-headingOne">
        <div class="accordion-body" id="left-content-column-filtering">
        </div>
      </div>
    </div>
    <div class="accordion-item">
      <h2 class="accordion-header" id="panelsStayOpen-headingTwo">
        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapseTwo" aria-expanded="false" aria-controls="panelsStayOpen-collapseTwo">
          Row Filtering
        </button>
      </h2>
      <div id="panelsStayOpen-collapseTwo" class="accordion-collapse collapse" aria-labelledby="panelsStayOpen-headingTwo">
        <div class="accordion-body" id="left-content-row-filtering">
        </div>
      </div>
    </div>
    <div class="accordion-item">
      <h2 class="accordion-header" id="panelsStayOpen-headingThree">
        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapseThree" aria-expanded="false" aria-controls="panelsStayOpen-collapseThree">
          Visualization
        </button>
      </h2>
      <div id="panelsStayOpen-collapseThree" class="accordion-collapse collapse" aria-labelledby="panelsStayOpen-headingThree">
        <div class="accordion-body" id="left-content-visualization">
        </div>
      </div>
    </div>
  </div>
</div>
<div class="col" id="right-content" style="width:50%">
  <div class="accordion" id="accordionPanelsStayOpenExample">
    <div class="accordion-item">
      <h2 class="accordion-header" id="panelsStayOpen-headingOne">
        <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapseOne" aria-expanded="true" aria-controls="panelsStayOpen-collapseOne">
          Column Filtering
        </button>
      </h2>
      <div id="panelsStayOpen-collapseOne" class="accordion-collapse collapse show" aria-labelledby="panelsStayOpen-headingOne">
        <div class="accordion-body" id="right-content-column-filtering">
        </div>
      </div>
    </div>
    <div class="accordion-item">
      <h2 class="accordion-header" id="panelsStayOpen-headingTwo">
        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapseTwo" aria-expanded="false" aria-controls="panelsStayOpen-collapseTwo">
          Row Filtering
        </button>
      </h2>
      <div id="panelsStayOpen-collapseTwo" class="accordion-collapse collapse" aria-labelledby="panelsStayOpen-headingTwo">
        <div class="accordion-body" id="right-content-row-filtering">
        </div>
      </div>
    </div>
    <div class="accordion-item">
      <h2 class="accordion-header" id="panelsStayOpen-headingThree">
        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapseThree" aria-expanded="false" aria-controls="panelsStayOpen-collapseThree">
          Visualization
        </button>
      </h2>
      <div id="panelsStayOpen-collapseThree" class="accordion-collapse collapse" aria-labelledby="panelsStayOpen-headingThree">
        <div class="accordion-body" id="right-content-visualization">
        </div>
      </div>
    </div>
  </div>
</div>
</div>
</div>
{% endblock content %}